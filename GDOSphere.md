# 潘宝祥博士团队又一力作——GDOSphere

**关注****地球与****人**

**工智能**，

**设置****EarthAi

星标**

  

  

# GDOSphere：一种用于天气预报的球面图神经网络框架与神经算子

![](./images/29fede46-4e93-48a5-a76c-2b54c42f2cac.jpg "null")

![图 1 展示了 GDOSphere 的框架设计。我们采用正二十面体球（icosphere）结构来重建地球表面空间，并运用多阶微分算子来近似动态核，从而实现高效的时空相关性捕捉能力。](./images/f8756ec5-6745-413e-9910-9a7cb666bdc6.jpg "null")

图 1 展示了 GDOSphere 的框架设计。我们采用正二十面体球（icosphere）结构来重建地球表面空间，并运用多阶微分算子来近似动态核，从而实现高效的时空相关性捕捉能力。

`Xu, Zhewen, Baoxiang Pan, Xiaohui Wei, Hongliang Li, Dongyuan Tian, and Zijian Li. "GDOSphere: A spherical graph neural network framework with neural operators for weather forecasting." Physica A: Statistical Mechanics and its Applications (2025): 130772.  `

### 研究背景

天气预报一直以来都是人类社会密切关注的领域。传统的数值天气预报（NWP）基于求解偏微分方程等复杂计算方法，存在计算成本高、初始参数依赖性强、数据同化过程复杂等问题。随着大数据和深度学习的发展，数据驱动的天气预报（DDWP）成为一种新的途径，它避免了繁琐的数值计算，直接从海量数据中生成端到端的预报结果。

然而，目前基于二维平面网格的 DDWP 方法存在地理信息与球面空间不兼容的问题，导致空间聚合性差，且物理规则中的多阶微分分量需要巨大的参数空间来拟合，训练和推理效率低。此外，没有物理约束的 DDWP 在大参数空间中面临非收敛和低效的挑战，难以同时实现高保真度和高效的训练。

![图2. 现有多项式方案在多尺度二十面体网格上的应用。我们设计了一种自适应多尺度网格组合算法，并将网格表面的值作为GNN的节点。](./images/52b58494-7f70-49bd-a83c-f9318ea1ac17.jpg "null")

图2. 现有多项式方案在多尺度二十面体网格上的应用。我们设计了一种自适应多尺度网格组合算法，并将网格表面的值作为GNN的节点。

### 研究意义

在此背景下，本研究提出了一种名为 GDOSphere 的物理信息架构，旨在解决现有 DDWP 方法的不足。

该架构利用多尺度球面空间上的定向微分，基于图微分算子（GDOs），将数据投影到统一的球面网格上，通过 GDOs 迭代聚合，然后再将数据重新映射回平面空间，并通过后处理补充时空细节，有望提高天气预报的准确性、训练效率和参数效率，为实际业务应用提供可能。

![图 3 GDOs的处理流程](./images/d1c5af0d-b56b-4ff6-bf61-8526c49f482b.jpg "null")

图 3 GDOs的处理流程

### 研究方法

*   •
    
     **图微分算子（GDOs）** ：GDOs 是 GDOSphere 的核心组件，包含嵌入值、多阶导数和交叉乘积，根据物理方程构建神经网络结构。它利用可学习的参数将可解析和不可解析的物理成分重新参数化，处理信号中的定向微分信息，提取基于物理规律的空间规律性。
    

例如，在处理大气运动的非线性偏微分方程时，GDOs 能够对空间输入进行一阶定向微分和拉普拉斯微分（二阶通用微分），以近似表达动力学和热力学中的动量平流分量和能量梯度分量等。通过这种方式，GDOs 能够捕捉大气状态变化中的时空数据变化规律，实现更高效、更符合物理实际的预报能力。

*   •
    
     **多尺度球面网格架构** ：GDOSphere 生成多尺度二十面体球面网格，将不均匀的经纬网格数据映射到球面上。这种多尺度网格架构可以解决单尺度球面网格带来的空间信息不平衡问题，避免非收敛现象，同时能够实现不同分辨率下不同区域的自适应分辨率集成。
    

具体来说，通过迭代细分单位二十面体的每个面来形成多尺度球面网格，将不同细分阶数的球体的粗网格节点作为细网格节点的子集，将各级网格层次的边叠加到最细分辨率的网格上，生成多尺度网格集合。在粗网格上连接远距离区域，在细网格上捕捉局部相互作用，从而更好地适应不同尺度的大气现象和过程。

*   •
    
     **迭代聚合与后处理** ：GDOSphere 采用迭代预测的方式，使用多个时间步长的天气状态来预测下一个时间步长的值。在迭代聚合过程中，通过 GDOs 块对不同分辨率的数据进行聚合，实现时空数据的有效整合和更新。
    

在数据后处理阶段，利用三维 U-Net 结构结合多头注意力机制，对从图重新映射回来的数据进行处理，增强因分辨率缩放而丢失的图像细节。通过计算均方误差（MSE）损失函数和图正则化损失函数，使用梯度下降法进行训练，优化模型参数，提高预报精度。

![图 4 GDOSphere架构概览](./images/b2109c40-92d5-48b1-bd9e-f67fcd67f46c.jpg "null")

图 4 GDOSphere架构概览

### 实验数据

实验主要使用 WeatherBench2 数据集，该数据集从欧洲气象中心提供的 ERA5 再分析数据中提取，包含了 1983 年到 2023 年共 40 年的数据。其中，1983 年到 2013 年的数据用于训练，2014 年到 2018 年的数据用于测试，2019 年到 2023 年的数据也用于测试。数据的分辨率为 0.25°（1440×720×36 的经纬网格数据），涵盖了多个大气变量，如 500 百帕的位势高度（Z500）、700 百帕的湿度（Q700）、850 百帕的温度（T850）和 850 百帕的 U/V 风速。

![图5. ACC和RMSE的预测技巧比较。](./images/aa9eb28e-516d-4971-b382-993d6d6da74d.jpg "null")

图5. ACC和RMSE的预测技巧比较。

![图6. 24小时预报的视觉比较。G.T.代表真实值（Ground Truth）](./images/57711e30-0a89-43f5-8257-85ed7e504a29.jpg "null")

图6. 24小时预报的视觉比较。G.T.代表真实值（Ground Truth）

![图7. ACU输出通道的敏感性分析](./images/37dc9d80-a6b9-4451-b04d-bd752e694919.jpg "null")

图7. ACU输出通道的敏感性分析

### 研究结果

*   •
    
     **预测性能提升** ：GDOSphere 在短期（24 小时）和中期（240 小时）天气预报中均取得了优异的性能。在与当前最佳方法相比，GDOSphere 在异常相关系数（ACC）和均方根误差（RMSE）等指标上表现出色，与最先进的方法相当，甚至在某些变量上超越了其他方法。例如，在 Z500 变量的 24 小时预报中，GDOSphere 的 ACC 为 0.9981，RMSE 为 42 m²/s²，与其他方法相比具有竞争力。
    

这表明 GDOSphere 能够有效地捕捉大气状态的变化规律，提高天气预报的准确性。其成功的关键在于将物理规律与深度学习相结合，通过图微分算子和多尺度球面网格架构，充分利用了物理知识和数据驱动的优势，解决了传统 DDWP 方法在空间聚合性和训练效率方面的不足。

*   •
    
     **训练效率和参数效率显著提高** ：GDOSphere 在训练效率和参数效率方面表现出显著的优势。与其他方法相比，GDOSphere 的训练时间大幅减少，最高可达 10 倍的加速。例如，在相同的批量大小和数据集下，与其他模型相比，GDOSphere 的训练时间从几百小时减少到 50 小时，同时参数量也大大减少。
    

这种效率的提升主要归功于 GDOs 的设计，它有效地减少了参数空间的需求，避免了传统 DDWP 方法在大参数空间中面临的非收敛和低效问题。通过将物理规律融入网络结构，GDOSphere 能够在有限的参数空间内实现高效的特征提取和模式识别，从而提高了训练和推理的速度。

*   •
    
     **跨模块的内容耦合** ：通过消融实验，研究发现 GDOSphere 的各个模块之间存在良好的协同作用。GDOs 是模型的主要组成部分，对预测性能的提升起到了关键作用。ACU（空气柱 U-Net）和 PP（后处理）模块也对模型的整体性能有显著的贡献。
    

例如，当仅使用 GDOs 时，模型的性能就有明显提升，而加入 ACU 和 PP 模块后，性能进一步提高。这表明 GDOSphere 的整体架构设计合理，各模块之间相互配合，共同实现了高效的天气预报。

### 结论与不足

*   •
    
     **结论** ：GDOSphere 作为一种新型的物理信息架构，将多尺度球面空间上的定向微分与图神经网络相结合，为天气预报提供了一种高效、准确的解决方案。通过图微分算子和多尺度球面网格架构，GDOSphere 能够有效地捕捉大气状态的变化规律，提高天气预报的精度，同时显著降低了训练时间和参数量，为实际业务应用提供了可能。
    
*   •
    
     **不足** ：尽管 GDOSphere 在天气预报领域取得了显著的成果，但仍存在一些不足之处。例如，GDOs 的设计虽然提高了物理一致性，但在处理复杂的物理过程时可能仍然存在一定的局限性。此外，GDOSphere 的训练过程可能对超参数的选择较为敏感，需要进一步优化和调整。
    

### 讨论

本研究的讨论部分主要围绕以下几点展开：

*   •
    
     **物理信息融合的优势** ：讨论了将物理规律与深度学习相结合的优势，指出这种融合能够有效提高模型的预测性能和泛化能力，减少对大规模数据和复杂训练过程的依赖。GDOSphere 的成功案例为其他领域的物理信息融合提供了有益的借鉴。
    
*   •
    
     **多尺度网格架构的潜力** ：深入探讨了多尺度网格架构在捕捉不同尺度大气现象方面的潜力，强调了该架构在提高模型分辨率和适应性方面的重要性。未来可以进一步探索多尺度网格架构在其他气象应用中的应用，如气候模拟和灾害预警等。
    
*   •
    
     **高效训练与推理的实现** ：分析了 GDOSphere 在训练效率和参数效率方面的优势，讨论了如何通过优化模型架构和算法来实现高效的训练和推理。这对于推动天气预报模型的实际应用具有重要意义。
    

### 未来工作

未来的工作可以从以下几个方面展开：

*   •
    
     **进一步优化 GDOs 的设计** ：针对 GDOs 的结构和参数进行更深入的研究和优化，提高其对复杂物理过程的模拟能力，进一步增强模型的物理一致性和预测精度。
    
*   •
    
     **拓展多尺度网格架构的应用** ：探索多尺度网格架构在其他气象变量和更长时间尺度预报中的应用，以及在更高分辨率数据下的表现，以满足不同气象业务的需求。
    
*   •
    
     **改进训练算法和超参数选择** ：研究更高效的训练算法和超参数优化方法，提高模型的训练效率和稳定性，减少对人工调整的依赖，使模型更具通用性和易用性。
    
*   •
    
     **与其他技术的结合** ：探索 GDOSphere 与其他先进技术（如机器学习、人工智能、高性能计算等）的结合，进一步提升天气预报的性能和应用价值。
    

以上是对文章的详细解读，如有不当之处欢迎批评指出！也可以私信小编（Earth\_Ai）。

  

![](./images/5c1a1e24-9ad9-4d09-93e1-d9eebad82117.jpg)

  

![](./images/b13dfc7d-a016-4c84-af65-af09f3d9c7ed.jpg)

**EarthAi**

微信公号：Earth-Ai

商务联系：Earth\_Ai

  

（

**加EarthAi微信交流群+商务合作，**请备注：姓名-行业-单位）

![](./images/05e42857-caba-432d-b1ca-484265593f7d.jpg)

* * *