# FourCastNet 3：球面几何 AI 引爆全球概率预报革命

**关注****地球与****人**

**工智能**，

**设置****EarthAi

星标**

  

# FourCastNet 3：面向可扩展概率机器学习天气预报的几何方法

![https://arxiv.org/abs/2507.12144](./images/70bbe831-286e-4045-bf7d-52070b05d1a1.jpg "null")

https://arxiv.org/abs/2507.12144

![FourCastNet 3模型](./images/6ecf30cd-2c3f-4ac5-99eb-5995c23fe94e.jpg "null")

FourCastNet 3模型

### 研究背景

#### 1\. 数值天气预报（NWP）的瓶颈

传统 NWP 基于偏微分方程离散求解，受限于：

*   • CFL 条件导致的高分辨率计算成本；
    
*   • 集合预报需要上百次积分，TFlop-days 量级；
    
*   • 对稀有事件采样不足，难以量化极值不确定性。
    

#### 2\. 机器学习天气模型的兴起

近两年，GraphCast、Pangu-Weather、GenCast 等模型在 0–5 天预报上已达到或超越 IFS-ENS 水平，但仍存在：

*   •
    
     **光谱漂移**：高频能量过度耗散或虚假累积；
    
*   •
    
     **概率校准差**：CRPS 优化导致空间相关性丢失；
    
*   •
    
     **推理延迟**：扩散模型需 20–50 步去噪，难以实时应用。
    

#### 3\. 球面几何的重要性

地球大气本质上定义在球面流形上。将 CNN/Transformer 直接用于经纬度网格会：

*   • 破坏旋转对称性；
    
*   • 在极区引入奇点；
    
*   • 导致谱泄漏与能量不守恒。
    

![](./images/dbedbfc5-8506-431d-bf12-8d6550f8772d.jpg)

FourCastNet 3 训练中的模型并行与数据并行示意图

* * *

### 研究意义

FourCastNet 3（FCN3）首次将

 **球面信号处理 + 隐马尔科夫概率框架 + 端到端光谱损失** 三者结合，实现：

维度

传统方法

FCN3 贡献

几何

经纬度卷积或图网络

纯球面卷积（全局谱卷积 + 局部 DISCO）

概率

后处理集合或扩散模型

隐变量扩散过程一次采样生成 50–1000 成员

训练

数据并行或模型并行分离

域分解式混合并行，1024 GPU 线性扩展

推理

需 CPU 集群数小时

单 H100 20 s 完成 90 天 0.25° 预报

光谱

高频衰减/爆炸

60 天仍保持 −5/3 斜率，无虚假能量堆积

* * *

### 研究方法

#### 1\. 概率建模：隐马尔科夫 + 球面扩散

*   • 状态转移：uₙ₊₁ = Fθ(uₙ, tₙ, zₙ)
    
      
    zₙ 服从球面扩散过程（Palmer et al. 2009 方案），通过 8 组不同 kT 长度尺度的球谐噪声注入实现多尺度随机强迫。
    
*   • 训练目标：
    
      
    L = L\_spatial\_CRPS + λ L\_spectral\_CRPS
    
      
    其中 L\_spectral 在球谐域按 m 汇总，确保跨尺度空间相关性。
    

#### 2\. 球面神经算子架构

*   •
    
     **编码器**：三组独立 DISCO 卷积将 721×1440 lat/lon 降采样到 360×720 Gaussian 网格，通道分组避免变量混叠。
    
*   •
    
     **处理器**：10 个 ConvNeXt 风格块，4:1 比例交替局部 DISCO 卷积与全局谱卷积；参数 7.1 亿。
    
*   •
    
     **解码器**：双线性插值 + DISCO 反卷积上采样；对水汽通道使用三次样条 soft-clamp 保证正值。
    

#### 3\. 可扩展并行训练

*   •
    
     **域分解**：沿经纬方向划分 (lat, lon) 通信组；FFT 与 Legendre 变换采用 pencil 分解。
    
*   •
    
     **三重并行**：
    

1.  1\. 模型并行：域分解，减少单卡显存；
    
2.  2\. 数据并行：批、集合成员独立；
    
3.  3\. 混合通信：all-to-all 用于谱变换，all-reduce 用于梯度。
    

训练规模：

*   • 阶段 1：332k 样本，1024 H100，78 小时；
    
*   • 阶段 2：55k 样本，512 A100，15 小时，4 步自回归；
    
*   • 微调：2012–2016 数据，256 H100，8 小时，8 步自回归。
    

* * *

### 数据

*   •
    
     **源**：ERA5 每小时 0.25°，1980–2018，39.5 TB；
    
*   •
    
     **变量**：
    

*   • 13 层大气：z, t, u, v, q（共 65 通道）；
    
*   • 7 个地表：10 m/100 m 风、2 m 气温、msl、tcwv 等；
    
*   • 静态辅助：海陆掩膜、地形、太阳天顶角；
    

*   •
    
     **预处理**：z-score 或 min-max 归一化，纬度权重积分。
    

* * *

### 研究结果

#### 1\. 概率技巧（2020 全年 12-hourly 初始场）

指标

FCN3

IFS-ENS

GenCast

CRPS ↓

**领先**

基准

几乎持平

Ensemble RMSE ↓

**领先**

基准

几乎持平

Spread–Skill Ratio

1.0 ± 0.1

1.0

1.0 但过离散

Rank Histogram

6 h 略过离散，>24 h 趋于均匀

参考

始终过离散

#### 2\. 确定性单成员表现

*   •
    
     **15 天 RMSE**：单 H100 64 s 完成，优于 IFS 单成员；
    
*   •
    
     **ACC**：>0.55 可达 10 天，与 IFS 持平；
    
*   •
    
     **光谱保真**：
    
      
    图 23、24 显示 60 天预报仍保持 −5/3 能量级串，无虚假高频堆积；而 GraphCast/NeuralGCM 在 10 天后即出现明显模糊。
    

#### 3\. 个例诊断：风暴 Dennis

*   • 2020-02-11 00 UTC 起报，120 h 前成功预测登陆爱尔兰；
    
*   • 850 hPa 风速、500 hPa 高度场与 ERA5 相关系数 >0.9；
    
*   • 50 成员集合给出极端风速 95 % 置信区间，早期预警价值高。
    

#### 4\. 计算效率

模型

硬件

15 天

时间

相对加速

FCN3

1×H100

0.25° 6 h

64 s

1×

GenCast

TPU v5

0.25° 12 h

8 min

**8×**

IFS-ENS

96×CPU

9 km 12 h

1 h

**60×**

* * *

### 结论与不足

#### 结论

1.  1.
    
     **几何忠实**：首次在球面流形上完成端到端概率预报，无经纬度网格伪影；
    
2.  2.
    
     **光谱一致**：60 天积分无能量漂移，为次季节预报奠定基础；
    
3.  3.
    
     **推理极快**：单卡秒级生成大集合，适合极端事件采样；
    
4.  4.
    
     **完全开源**：训练、推理、评估脚本全链路开放，可复现、可扩展。
    

#### 不足

*   •
    
     **物理约束缺失**：无质量、能量守恒硬约束，长期积分可能出现微量漂移；
    
*   •
    
     **降水诊断**：目前仅输出水汽，需后续耦合微物理方案；
    
*   •
    
     **初始扰动**：未引入观测不确定性的 bred-vector 类扰动，集合离散度略低；
    
*   •
    
     **极端事件**：对热带气旋内核结构、对流爆发等超高分辨率过程仍显平滑。
    

* * *

### 讨论

#### 1\. 与扩散模型的比较

GenCast 采用 20 步去噪，每一步需一次前向传播；FCN3 仅需一次采样即得 50 成员。虽然 GenCast 对 t2m 略优，但 FCN3 的 6 h 步长可更好地捕捉日循环。

#### 2\. 与混合 NWP-ML 的比较

NeuralGCM 在 30 天后仍保持 ACC>0.4，但光谱高频已明显衰减。FCN3 通过光谱 CRPS 强制约束，避免了“过度平滑”。

#### 3\. 工程启示

*   • 域分解 + 集合并行是科学 ML 的“正确”并行范式，而非 NLP 的 FSDP；
    
*   • 光谱域并行通信量大，需 NVLink + SHARP 支持，否则成为瓶颈；
    
*   • 推理端直接在线打分，避免 PB 级存储，为业务化扫清障碍。
    

* * *

### 未来工作

1.  1.
    
     **同化耦合**：引入 4D-Var/EnKF 误差扰动，构建完整数据同化-预报闭环；
    
2.  2.
    
     **降水与辐射**：耦合快速辐射方案、神经网络微物理，实现全变量预报；
    
3.  3.
    
     **公里尺度**：0.05° 或 1 km 区域嵌套，利用 DISCO 卷积局部化优势；
    
4.  4.
    
     **多圈层**：海洋-海冰-陆面耦合，探索 MJO、ENSO 次季节可预报性；
    
5.  5.
    
     **极端事件库**：基于 FCN3 大集合构建 1000 年全球热带气旋、热浪、极端降水数据库。
    

* * *

### 精简总结

FourCastNet 3 用“球面几何 + 概率扩散 + 光谱守恒”三板斧，把机器学习天气预报从“可用”推向“可信、可快、可扩展”的新阶段，真正打开了次季节大集合实时业务化的大门。

以上是对文章的详细解读，如有不当之处欢迎批评指出！也可以私信小编（Earth\_Ai）。

![](./images/a652b70d-6a5b-4f07-a22d-f0dcc4dc817b.jpg)

  

![](./images/bc86e7b7-fcd9-4b5b-ad4b-934de64ebb9b.jpg)

**EarthAi**

微信公号：Earth-Ai

商务联系：Earth\_Ai

  

（

**加EarthAi微信交流群+商务合作，**请备注：姓名-行业-单位）

![](./images/294eeb38-de98-44f1-8201-9ff5bd777080.jpg)